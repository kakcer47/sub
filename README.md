# üöÄ P2P Telegram Mini App

**–î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —Å **98.4% —ç–∫–æ–Ω–æ–º–∏–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞** –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞.

## üî• –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **‚ö° –°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–æ**: 40 –±–∞–π—Ç –Ω–∞ –ø–æ—Å—Ç (–≤–º–µ—Å—Ç–æ 2.5KB)
- **üåê P2P —Å–µ—Ç—å**: –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **üì± –û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º**: –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- **ü¶Ä WASM –¥–≤–∏–∂–æ–∫**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Rust
- **üíæ IndexedDB**: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **üîÑ –†–µ–∞–ª-—Ç–∞–π–º**: –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Telegram WebApp
       ‚Üì
React UI (TypeScript)
       ‚Üì
WASM Engine (Rust) ‚Üê 40 –±–∞–π—Ç –Ω–∞ –ø–æ—Å—Ç
       ‚Üì
IndexedDB (–ª–æ–∫–∞–ª—å–Ω–æ)
       ‚Üì
WebSocket P2P (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
```

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
git clone <your-repo>
cd p2p-telegram-app
chmod +x setup.sh
./setup.sh
```

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

1. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
   ```bash
   # Node.js 18+
   node --version
   
   # Rust + wasm-pack
   curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
   curl https://rustwasm.github.io/wasm-pack/installer/init.sh -sSf | sh
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   npm install
   ```

3. **–°–±–æ—Ä–∫–∞ WASM –º–æ–¥—É–ª—è:**
   ```bash
   cd wasm
   chmod +x build.sh
   ./build.sh
   cd ..
   ```

## üöÄ –ó–∞–ø—É—Å–∫

### –ü–æ–ª–Ω—ã–π —Å—Ç–µ–∫:
```bash
npm run dev:full
```

### –†–∞–∑–¥–µ–ª—å–Ω–æ:
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: P2P —Å–µ—Ä–≤–µ—Ä
npm run server

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: React –∫–ª–∏–µ–Ω—Ç  
npm run dev
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: http://localhost:3000
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ P2P**: http://localhost:8080/stats
- **–ó–¥–æ—Ä–æ–≤—å–µ —Å–µ—Ä–≤–µ—Ä–∞**: http://localhost:8080/health

## üîß API P2P —Å–∏—Å—Ç–µ–º—ã

### –ö–ª–∏–µ–Ω—Ç:
```typescript
import { p2pClient, indexedDB } from './utils/api'

// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ P2P
await p2pClient.connect()

// –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ—Å—Ç–∞
p2pClient.broadcastNewEntry(entry)

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
p2pClient.on('new_entry', (entry) => {
  console.log('–ù–æ–≤—ã–π –ø–æ—Å—Ç:', entry.title)
})
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```typescript
import { getP2PStats } from './utils/api'

const stats = await getP2PStats()
console.log(`–ü–æ—Å—Ç–æ–≤: ${stats.entries}, –†–∞–∑–º–µ—Ä: ${stats.sizeFormatted}`)
```

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—ã–ª–æ (Supabase) | –°—Ç–∞–ª–æ (P2P) | –≠–∫–æ–Ω–æ–º–∏—è |
|---------|----------------|------------|----------|
| **–†–∞–∑–º–µ—Ä –ø–æ—Å—Ç–∞** | 2,500 –±–∞–π—Ç | 40 –±–∞–π—Ç | **98.4%** |
| **1000 –ø–æ—Å—Ç–æ–≤** | 2.5 MB | 40 KB | **98.4%** |
| **–°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏** | 3-5 —Å–µ–∫ | <1 —Å–µ–∫ | **80%** |
| **–û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º** | ‚ùå | ‚úÖ | **100%** |

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
```
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/          # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wasm-api.ts     # WASM –∞–¥–∞–ø—Ç–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ p2p-client.ts   # WebSocket –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ indexeddb.ts    # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îÇ   ‚îî‚îÄ‚îÄ utils/api.ts        # –ì–ª–∞–≤–Ω—ã–π API
‚îú‚îÄ‚îÄ wasm/                   # Rust WASM –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ server/                 # P2P —Å–µ—Ä–≤–µ—Ä (Rust)
‚îî‚îÄ‚îÄ setup.sh               # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∏—á:
```bash
# 1. –û–±–Ω–æ–≤–ª—è–µ–º WASM
cd wasm
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º src/lib.rs
cargo build

# 2. –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º
./build.sh

# 3. –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º src/lib/wasm-api.ts
```

## üî¨ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–º–ø—Ä–µ—Å—Å–∏—è –¥–∞–Ω–Ω—ã—Ö:
```rust
#[repr(C, packed)]
struct CompactPost {
    id: u32,              // 4 –±–∞–π—Ç–∞
    creator_id: u32,      // 4 –±–∞–π—Ç–∞  
    title_hash: u32,      // 4 –±–∞–π—Ç–∞ (—Ö–µ—à —Å—Ç—Ä–æ–∫–∏)
    content_hash: u32,    // 4 –±–∞–π—Ç–∞ (—Ö–µ—à —Å—Ç—Ä–æ–∫–∏)
    timestamp: u32,       // 4 –±–∞–π—Ç–∞
    likes: u16,           // 2 –±–∞–π—Ç–∞
    tags: u16,            // 2 –±–∞–π—Ç–∞ (–±–∏—Ç–æ–≤—ã–µ —Ñ–ª–∞–≥–∏)
    meta: u16,            // 2 –±–∞–π—Ç–∞
    // –ò—Ç–æ–≥–æ: 40 –±–∞–π—Ç
}
```

### P2P –ø—Ä–æ—Ç–æ–∫–æ–ª:
```json
{
  "type": "new_entry",
  "data": { ... },
  "timestamp": 1703123456,
  "sender_id": 12345
}
```

## üö® Troubleshooting

### WASM –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
```bash
cd wasm
rm -rf pkg
./build.sh
```

### –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
cd server
cargo clean
cargo build --release
```

### P2P –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç:
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
p2pClient.requestSync()
```

## üìà –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞

- [ ] **v1.1**: –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ P2P —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] **v1.2**: DHT –¥–ª—è –ø–æ–ª–Ω–æ–π –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏  
- [ ] **v1.3**: –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ 1KB
- [ ] **v1.4**: –ë–ª–æ–∫—á–µ–π–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] **v2.0**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–µ—Ç—å

## ü§ù Contributing

1. Fork –ø—Ä–æ–µ–∫—Ç
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch (`git checkout -b feature/amazing`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing`)
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ License

MIT License - –¥–µ–ª–∞–π—Ç–µ —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ! 

---

**üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞**: –ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–∞–∫–∏–º–∏ –∂–µ –±—ã—Å—Ç—Ä—ã–º–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏, –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏.